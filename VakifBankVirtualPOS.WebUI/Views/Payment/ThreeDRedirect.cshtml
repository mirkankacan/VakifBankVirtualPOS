@{
    ViewData["Title"] = "3D Secure Doğrulama";
    ViewData["NoIndex"] = true;

}

<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title text-center">
                    <img src="~/theme/assets/images/egesehir.png" class="img-fluid" />
                </h5>
                <div class="text-center">
                    <div class="spinner-border text-egesehir" role="status" style="width: 3rem; height: 3rem;">
                        <span class="sr-only"></span>
                    </div>
                    <h3 class="mt-4 text-egesehir">3D Secure Doğrulama</h3>
                    <p class="text-muted mt-3">Ödeme işleminiz için 3D Secure doğrulaması yapılıyor.</p>
                    <p class="text-muted">Lütfen bekleyin, banka sayfasına yönlendiriliyorsunuz...</p>
                </div>
            </div>
        </div>
    </div>
</div>

@if (ViewBag.ACSUrl != null && !string.IsNullOrEmpty(ViewBag.ACSUrl.ToString()))
{
    <form id="threeDSecureForm" method="post" action="@ViewBag.ACSUrl" style="display: none;">
        <input type="hidden" name="PaReq" value="@ViewBag.PAReq" />
        <input type="hidden" name="TermUrl" value="@ViewBag.TermUrl" />
        <input type="hidden" name="MD" value="@ViewBag.MD" />
    </form>

    @section Scripts {
        <script>
            // Formu otomatik submit et
            $(document).ready(function () {
                setTimeout(function () {
                    document.getElementById('threeDSecureForm').submit();
                }, 1000); // 1 saniye bekle, sonra yönlendir
            });
        </script>
    }
}
else
{
    <div class="row mt-3">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <div class="alert alert-warning">
                        <h4 class="alert-heading">3D Secure Bilgileri Bulunamadı</h4>
                        <p>3D Secure doğrulama bilgileri alınamadı. Lütfen tekrar deneyiniz.</p>
                        @if (ViewBag.Status != null)
                        {
                            <p><strong>Durum:</strong> @ViewBag.Status</p>
                        }
                        @if (ViewBag.Message != null)
                        {
                            <p><strong>Mesaj:</strong> @ViewBag.Message</p>
                        }
                        <hr>
                        <a href="@Url.Action("Index", "Payment")" class="btn btn-egesehir">Ödeme Sayfasın Dön</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
}